import java.io.BufferedWriter;import java.io.File;
import java.io.FileWriter;
import java.io.IOException;
import java.io.PrintWriter;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;





import com.mysql.cj.jdbc.result.ResultSetMetaData;




public class contenu {
	


public static void main(String[] args) {
	
		try {
		  
			Class.forName("com.mysql.cj.jdbc.Driver");
   String url ="jdbc:mysql://localhost:3306/ter?useUnicode=true&useJDBCCompliantTimezoneShift=true&useLegacyDatetimeCode=false&serverTimezone=UTC";       
	String username ="root";
	String password ="I.perche7";
	Connection conn= DriverManager.getConnection(url, username, password);
	 Statement state = (Statement) conn.createStatement();
     //L'objet ResultSet contient le résultat de la requête SQL
     ResultSet result = ((java.sql.Statement) state).executeQuery("SELECT contenu_mail_propre FROM td_mail");
	     
	         
	      int i=1;
	      while(result.next()){  
	    	File fw= new File(String.valueOf(i)+".txt");
		      PrintWriter pw = new PrintWriter(fw);
	        	pw.write(" "+result.getString("contenu_mail_propre"));
	        	pw.close();
	        	i++;
	        	

	      }

	      result.close();
	      state.close();
	         
	    } catch (Exception e) {
	      e.printStackTrace();
	    }      
		
		
		
	
	}}

